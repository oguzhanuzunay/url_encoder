<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Beko Global Tool</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />

    <style>
      #holder {
        border: 10px dashed #ccc;
        width: 300px;
        height: 300px;
        margin: 20px auto;
      }
      #holder.hover {
        border: 10px dashed #333;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand mx-5" href="#">
          <img
            src="https://www.beko.com/content/dam/selectyourcountry/images/frontend/facelift-2017/logo.svg"
            width="64"
            height="64"
            class="d-inline-block align-top"
            alt=""
          />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavAltMarkup"
          aria-controls="navbarNavAltMarkup"
          aria-expanded="true"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse flex-row justify-content-center"
          id="navbarNavAltMarkup"
        >
          <div class="navbar-nav w-75">
            <a id="sku" class="nav-item text-danger h4 nav-link active" href="#"
              >SKU</a
            >
            <a id="impex" class="nav-item h4 nav-link" href="#">Impex</a>
            <a id="country" class="nav-item h4 nav-link disabled" href="#"
              >(Country) Soon...</a
            >
          </div>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="row" id="url_encoder">
        <div class="row mt-5">
          <div class="col-sm">
            <div class="mb-3">
              <label for="exampleFormControlTextarea1" class="form-label"
                >Input</label
              >
              <textarea class="form-control" id="url" rows="3"></textarea>
            </div>
          </div>
        </div>
        <div class="row align-content-center justify-content-center">
          <div class="col-sm">
            <div class="row justify-content-center">
              <div class="btn-group skus" role="group">
                <button
                  name="URL Encode"
                  id="convert"
                  type="submit"
                  class="btn btn-outline-primary"
                >
                  URL Encode
                </button>

                <button
                  class="btn btn-outline-primary"
                  name="Sort"
                  id="sort"
                  type="submit"
                >
                  SKU ; SKU
                </button>

                <button
                  class="btn btn-outline-primary"
                  name="SortComma"
                  id="SortComma"
                  type="submit"
                >
                  SKU , SKU
                </button>

                <button
                  class="btn btn-outline-primary"
                  id="deleteDublicate"
                  name="Delete SKU Dublicates"
                  for="btncheck3"
                >
                  Delete SKU Dublicates
                </button>
              </div>
              <div class="btn-group mt-2 impexs" role="group">
                <button
                  name='Category (;p_code;"p_name";)'
                  id="impex1"
                  type="submit"
                  class="btn btn-outline-dark impex1"
                >
                  Category (;p_code;"p_name";)
                </button>

                <button
                  class="btn btn-outline-dark"
                  name=' Category Computed Title (;p_code; "p_name
                  p_producttitletemplate";)'
                  id="impex2"
                  type="submit"
                >
                  Category Computed Title (;p_code; "p_name
                  p_producttitletemplate";)
                </button>
                <button
                  name='Classifaction Class (;p_code;"p_name";)'
                  id="impex1"
                  type="submit"
                  class="btn btn-outline-dark impex1"
                >
                  Classifaction Class (;p_code;"p_name";)
                </button>
                <button
                  class="btn btn-outline-dark"
                  name='Facet (;$solrIndexedType;p_name;"p_displayname";)'
                  id="impex4"
                  type="submit"
                >
                  Facet (;$solrIndexedType;p_name;"p_displayname";)
                </button>
              </div>
              <div class="btn-group mt-2 impexs" role="group">
                <button
                  class="btn btn-outline-dark"
                  name='Consumer Centric (;p_code;"p_title";"p_subtitle";)'
                  id="impex3"
                  type="submit"
                >
                  Consumer Centric (;p_code;"p_title";"p_subtitle";)
                </button>
                <button
                  name='Consumer Centric Range (;p_code;"p_title";)'
                  id="impex1"
                  type="submit"
                  class="btn btn-outline-dark impex1"
                >
                  Consumer Centric Range (;p_code;"p_title";)
                </button>
                <button
                  name='Attributes (;p_code;"p_name";)'
                  id="impex1"
                  type="submit"
                  class="btn btn-outline-dark impex1"
                >
                  Attributes (;p_code;"p_name";)
                </button>
                <button
                  name=';Attributes Values (;p_code;"p_name";)'
                  id="impex1"
                  type="submit"
                  class="btn btn-outline-dark impex1"
                >
                  Attributes Values (;p_code;"p_name";)
                </button>
              </div>
              <div class="btn-group mt-2 impexs" role="group">
                <button
                  name=';Attributes Values (;p_code;"p_name";)'
                  id="computedTitleMaker"
                  type="submit"
                  class="btn btn-outline-dark impex1"
                >
                  Computed Title Maker ( CaregoryID, Computed Title Set, L1, L1
                  Tra, L2, L2 Tra, L3, L3 Tra)
                </button>
              </div>
              <div class="mt-2 countrys row" role="group">
                <div class="col-sm d-flex flex-row">
                  <a href="#" target="_blank" id="countryFlagUrl">
                    <img
                      src=""
                      class="rounded"
                      id="countryFlag"
                      width="300px"
                      alt="flag"
                      ss="https://www.elasticpath.com/sites/default/files/2020-05/CMS_Page_Adobe_Experience_Manager_Logo.png"
                    />
                  </a>
                  <div class="d-flex p-2 flex-column">
                    <div class="d-flex p-2 bd-highlight ms-4">
                      <p class="fw-bold mx-2">
                        Country Name :
                        <span id="countryName" class="fw-normal"></span>
                      </p>
                      <p class="fw-bold mx-2">
                        ISO Code :
                        <span id="countryIso" class="fw-normal"></span>
                      </p>
                      <p class="fw-bold mx-2">
                        Languge Code :
                        <span id="countryLanguge" class="fw-normal"></span>
                      </p>
                    </div>
                    <div class="d-flex p-2 bd-highlight ms-4">
                      <p class="fw-bold mx-2">
                        PATH :
                        <span id="countryPath" class="fw-normal"></span>
                      </p>
                      <p class="fw-bold mx-2">
                        URL :
                        <a
                          href="#"
                          target="_blank"
                          id="countryUrl"
                          class="fw-normal"
                        ></a>
                      </p>
                    </div>
                    <div
                      class="d-flex p-2 bd-highlight ms-4 justify-content-around"
                    >
                      <a
                        href="https://author-arcelik-prod-65.adobecqms.net/sites.html/content"
                        target="_blank"
                        id="aemImage"
                      >
                        <img
                          src="https://www.elasticpath.com/sites/default/files/2020-05/CMS_Page_Adobe_Experience_Manager_Logo.png"
                          class="rounded"
                          width="200px"
                          alt="aem"
                        />
                      </a>
                      <a
                        href="https://hybris.arcelik.com/backoffice/login.zul"
                        target="_blank"
                        id="pcmImage"
                        class=""
                      >
                        <img
                          src="https://cdn.freelogovectors.net/wp-content/uploads/2018/05/sap-hybris-logo.png"
                          class="rounded"
                          width="200px"
                          alt="pcmI"
                        />
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row mt-5">
          <div class="col-sm">
            <div class="mb-3">
              <label for="exampleFormControlTextarea1" class="form-label"
                >Output</label
              >
              <textarea
                class="form-control"
                id="encodedUrl"
                rows="3"
                readonly
              ></textarea>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm">
            <button
              name="Copy All"
              id="copy"
              type="submit"
              class="btn btn-lg btn-danger mb-3"
            >
              Copy All
            </button>
          </div>
        </div>
        <div class="row skus">
          <div class="col-sm">
            <div id="holder"></div>
            <p id="status">Drag and Drop</p>
          </div>
        </div>
      </div>
    </div>

    <script>
      const convert = document.getElementById('convert');
      const copy = document.getElementById('copy');
      const textNode = document.getElementById('encodedUrl');
      const textArea = document.getElementById('url');
      const showEncoder = document.getElementById('url_encoder_button');
      const SortButton = document.getElementById('sort');
      const deleteDublicates = document.getElementById('deleteDublicate');
      const sortbyCommaButton = document.getElementById('SortComma');
      const impex1 = document.querySelectorAll('.impex1');
      const impex2 = document.getElementById('impex2');
      const impex3 = document.getElementById('impex3');
      const impex4 = document.getElementById('impex4');
      const skusButtonGroup = document.querySelectorAll('.skus');
      const impexButtonGroups = document.querySelectorAll('.impexs');
      const countryButtonGroup = document.querySelectorAll('.countrys');
      const showSkuButton = document.getElementById('sku');
      const showImpexButton = document.getElementById('impex');
      const showCountryButton = document.getElementById('country');
      const computedTitleMaker = document.getElementById('computedTitleMaker');

      //--------------------------------
      // Show and Hide Buttons
      const ShowComponent = (componentName, displayStatus) => {
        typeof componentName === 'object'
          ? componentName.forEach(
              (group) => (group.style.display = `${displayStatus}`)
            )
          : (componentName.style.display = `${displayStatus}`);
      };
      //------------------------------
      const showSkuGroup = () => {
        showSkuButton.classList = 'nav-item text-danger h4 nav-link active';
        showImpexButton.classList = 'nav-item h5 nav-link ';
        showCountryButton.classList = 'nav-item h5 nav-link disabled';

        ShowComponent(skusButtonGroup, '');
        ShowComponent(impexButtonGroups, 'none');
        ShowComponent(countryButtonGroup, 'none');

        ShowComponent([textArea, textNode, copy], '');
        ShowComponent(document.querySelectorAll('.form-label'), '');
      };
      const showImpexGroup = () => {
        showSkuButton.classList = 'nav-item h5 nav-link';
        showImpexButton.classList = 'nav-item text-danger h4 nav-link active ';
        showCountryButton.classList = 'nav-item h5 nav-link disabled';

        ShowComponent(skusButtonGroup, 'none');
        ShowComponent(impexButtonGroups, '');
        ShowComponent(countryButtonGroup, 'none');

        ShowComponent([textArea, textNode, copy], '');
        ShowComponent(document.querySelectorAll('.form-label'), '');
      };
      const showCountryGroup = () => {
        showSkuButton.classList = 'nav-item h5 nav-link';
        showImpexButton.classList = 'nav-item h5 nav-link  ';
        showCountryButton.classList = 'nav-item text-danger h4 nav-link active';

        ShowComponent(skusButtonGroup, 'none');
        ShowComponent(impexButtonGroups, 'none');
        ShowComponent(countryButtonGroup, '');

        ShowComponent([textArea, textNode, copy], 'none');
        ShowComponent(document.querySelectorAll('.form-label'), 'none');
      };
      //-----------------------------------START PAGE
      showImpexGroup();
      //----------------------------------------------------------------
      let arrayOfLines = [];
      let newArray = [];
      var holder = document.getElementById('holder'),
        state = document.getElementById('status');

      const splitLine = () => {
        arrayOfLines = [];
        arrayOfLines = textArea.value.split('\n');
        //console.log(arrayOfLines);
        return arrayOfLines;
      };

      const encodetoArray = (arr) => {
        let newArr = [];
        arr.forEach((element) => {
          newArr.push(encodeURI(element));
        });
        return newArr;
      };

      const sortSKU = (a) => {
        let arr = splitLine();
        let sku = '';
        arr.map((value) => {
          sku = sku + value + a;
        });

        return sku;
      };

      const delDuplicates = (array) =>
        array.filter((item, index) => array.indexOf(item) === index);

      const versusSKu = () => {
        let arr = splitLine();
      };
      //----------------------------------- SKU ; SKU
      const showSKU = () => {
        let sku = sortSKU(';');
        write(sku, textNode);
      };
      //------------------------------------ SKU , SKU
      const showSKUComma = () => {
        let sku = sortSKU(',');
        write(sku, textNode);
      };
      //------------------------------------ dublicate delete
      const noDublicate = () => {
        let arr = splitLine();
        arr = delDuplicates(arr);
        write(arr, textNode);
        copyOnchange();
      };

      //------------------------------------ Impex-1
      const makeImpex1 = () => {
        let arr = splitLine();
        let impex = impexMaker(arr, 1);
        write(impex, textNode);
        copyOnchange();
      };
      //------------------------------------ Impex-2
      const makeImpex2 = () => {
        let arr = splitLine();
        let impex = impexMaker(arr, 1);

        write(impex, textNode);
        copyOnchange();
      };
      //------------------------------------ Impex-3
      const makeImpex3 = () => {
        let arr = splitLine();
        let impex = impexMaker(arr, 2);

        write(impex, textNode);
        copyOnchange();
      };
      //--------------------------------------- Impex-4
      const makeImpex4 = () => {
        let arr = splitLine();
        let impex = impexMaker(arr, 3);
        write(impex, textNode);
        copyOnchange();
      };
      //--------------------------------------
      const makeComputedTitle = () => {
        let arr = splitLine();
        let impex = impexMaker(arr, 5);
        write(impex, textNode);
        copyOnchange();
      };

      const impexMaker = (arr, impexType) => {
        impexRule1 = (str) => {
          return (str = `;${str[0]};"${str[1]}${str[2] ? ' ' + str[2] : ''}";`);
        };
        const spStr = `'') `;

        const metricChanger = (value, static, elmnt1, elmnt2) => {
          let res = '';
          elmnt1 !== '-' || elmnt2 !== ''
            ? (res = value.replace(`${static}${elmnt1}`, elmnt2))
            : (res = value);
          return res;
        };

        let impex = arr.map((str) => {
          str = str.split(/\t/);
          if (str.length === 1) {
            return '';
          } else {
            if (impexType == 5) {
              str[1] = str[1].replace(str[2], str[3]);
              str[1] = metricChanger(str[1], spStr, str[4], str[5]);
              str[1] = metricChanger(str[1], spStr, str[6], str[7]);
              //  str[1] = str[1].replace(`${spStr}${str[4]}`, str[5]);
              //  str[1] = str[1].replace(`${spStr}${str[6]}`, str[7]);
              let result = [str[0], str[1]];
              console.log(impexRule1(result));
              return impexRule1(result);
            }
            if (impexType === 1) {
              return (str = `;${str[0]};"${str[1]}${
                str[2] ? ' ' + str[2] : ''
              }";`);
            } else if (impexType === 2) {
              return (str = `;${str[0] ? str[0] : ''};"${
                str[1] ? str[1] : ''
              }";"${str[2] ? str[2] : ''}";`);
            } else if (impexType === 3) {
              return (str = `;$solrIndexedType;${str[0]};"${str[1]}${
                str[2] ? ' ' + str[2] : ''
              }";`);
            }
          }
        });

        return impex;
      };

      //---------------------------------------------------------------

      const showUrl = () => {
        let arr = splitLine();
        let encodedarr = encodetoArray(arr);
        write(encodedarr, textNode);
      };
      const write = (Arr, txtArea) => {
        let text = '';

        typeof Arr !== 'string'
          ? Arr.forEach((element) => {
              element === ''
                ? element
                : text === ''
                ? (text = `${element}`)
                : (text = `${text}\n${element}`);
            })
          : (text = Arr);
        txtArea.value = text;
      };

      const calculate = (area) => {
        result = area.value.split('\n');
        result = result.filter((item) => item !== '');
        return result.length;
      };

      const count = (txtArea, btn) => {
        let number = calculate(txtArea);

        btn.textContent = `${btn.name} (${number})`;
      };

      const copyClipboard = () => {
        textNode.select();
        //textNode.setSelectionRange(0, 9999999999999); /* For mobile devices */
        setTimeout(() => document.execCommand('copy'), 300);
      };
      const convertOnchange = () => {
        count(textArea, convert);
        count(textArea, deleteDublicates);
      };
      const copyOnchange = () => {
        count(textNode, copy);
      };

      convert.addEventListener('click', showUrl);
      copy.addEventListener('click', copyClipboard);
      textArea.addEventListener('keyup', convertOnchange);
      convert.addEventListener('click', copyOnchange);
      SortButton.addEventListener('click', showSKU);
      deleteDublicates.addEventListener('click', noDublicate);
      sortbyCommaButton.addEventListener('click', showSKUComma);
      impex1.forEach((button) => button.addEventListener('click', makeImpex1));
      impex2.addEventListener('click', makeImpex2);
      impex3.addEventListener('click', makeImpex3);
      impex4.addEventListener('click', makeImpex4);
      computedTitleMaker.addEventListener('click', makeComputedTitle);
      //----
      showCountryButton.addEventListener('click', showCountryGroup);
      showSkuButton.addEventListener('click', showSkuGroup);
      showImpexButton.addEventListener('click', showImpexGroup);
      //-------------------------------DEV-------------------------------------------------

      if (typeof window.FileReader === 'undefined') {
        state.className = 'fail';
      } else {
        state.className = 'success';
        state.innerHTML = 'Drop to .txt File';
      }

      holder.ondragover = function () {
        this.className = 'hover';
        return false;
      };
      holder.ondragend = function () {
        this.className = '';
        return false;
      };
      holder.ondrop = function (e) {
        this.className = '';
        e.preventDefault();

        var file = e.dataTransfer.files[0],
          reader = new FileReader();
        reader.onload = function (event) {
          textArea.value = event.target.result;
          setTimeout(convertOnchange, 50);
        };
        reader.readAsText(file);
        //setTimeout(splitLine, 100);
        //setTimeout(copyOnchange, 101);
        return false;
      };
      //--------------------------------------------------------------------------

      const getCountryByName = (name) => {
        const url = `https://restcountries.eu/rest/v2/name/${name}`;
        fetch(url)
          .then((response) => response.json())
          .then((data) => getCountryInfo(data));
      };
      const getCountryByISO = (iso) => {
        const url = `https://restcountries.eu/rest/v2/name/${iso}`;
      };

      const getCountryInfo = (obj) => {
        obj = obj[0];
        const country = {
          flag: obj.flag,
          name: obj.name,
          iso: obj.alpha2Code,
          language: obj.languages[0].iso639_1,
          path: '/' + obj.alpha2Code + '-' + obj.languages[0].iso639_1,
          url: `https://www.beko.com/${obj.alpha2Code}-${obj.languages[0].iso639_1}`,
        };
        showCountryInfo(country);
      };
      const showCountryInfo = (country) => {
        document.getElementById('countryFlag').src = country.flag;
        document.getElementById(
          'countryFlagUrl'
        ).href = country.url.toLowerCase();
        document.getElementById('countryName').innerHTML = country.name;
        document.getElementById('countryIso').innerHTML = country.iso;
        document.getElementById('countryLanguge').innerHTML = country.language;
        document.getElementById('countryPath').innerHTML = country.path;
        document.getElementById(
          'countryUrl'
        ).innerHTML = country.url.toLowerCase();
        document.getElementById('countryUrl').href = country.url.toLowerCase();
        document.getElementById(
          'aemImage'
        ).href = `https://author-arcelik-prod-65.adobecqms.net/sites.html/content/bekoglobal/${country.iso}/${country.language}`.toLowerCase();

        //import Link https://author-arcelik-prod-65.adobecqms.net/mnt/overlay/commerce/gui/content/catalogs/properties.html?item=/content/catalogs/bekoglobal/es-es
        //dam assets  https://author-arcelik-prod-65.adobecqms.net/assets.html/content/dam/angola-ao-aem/angola-ao-aemProductCatalog
      };

      getCountryByName('usa');
    </script>
    <script
      src="https://code.jquery.com/jquery-3.6.0.slim.min.js"
      integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
